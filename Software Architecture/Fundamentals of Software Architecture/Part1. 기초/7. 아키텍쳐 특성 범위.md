# 7. 아키텍쳐 특성 범위

- 아키텍트는 운영 아키텍쳐 특성을 따져보고, 아키텍쳐 특성에 영향을 미치는 코드베이스 외부의 컴포넌트를 잘 살펴봐야 한다.  
  이런 종류의 의존성을 측정하기 위해 아키텍쳐 퀀텀이라는 용어가 등장했는데, 아키텍쳐 퀀텀을 이해하려먼 먼저 커네이선스라는  
  핵심 메트릭을 잘 알아두어야 한다.

---

## 7.1 커플링과 커네이선스

- 3장에서 살펴본 구심/원심 커플링 같은 코드 레벨의 커플링 메트릭은 아키텍쳐 분석용으로는 너무 세분도가 높다.

- 두 컴포넌트 중 한쪽에 변경될 경우, 다른 한 쪽도 변경해야 전체 시스템의 정합성이 맞는다면 이들은 커네이선스를 갖는다고 표현한다.

- 커네이선스는 정적 코드 분석으로 발견할 수 있는 정적 커네이선스와, 런타임 동작에 대한 동적 커네이선스로 분류된다.  
  아키텍쳐 퀀텀을 정의하려면 컴포넌트가 어떻게 서로 '연결되어' 있는지 측정할 방법이 필요한데, 이것이 바로 커네이선스라는 개념이다.  
  예를 들어, MSA에서 두 서비스가 `address` 라는 동일한 클래스를 공유한다면 이 두 서비스는 서로 정적인 커네이선스를 가진다고 볼 수 있다.  
  다시 말해, `address` 라는 공유 클래스를 변경하면 이 두 서비스를 모두 변경해야 한다.

- 동적 커네이선스는 동기, 비동기의 두 종류가 있다. 분산 서비스끼리 동기 호출을 하면 호출부는 피호출부의 응답을 기다려야 하는 반면,  
  이벤트 기반 아키텍쳐의 비동기 호출은 fire-and-forget 방식이므로 운영 아키텍쳐에서 이 두 서비스는 개별적으로 작동시킬 수 있다.

---

## 7.2 아키텍쳐 퀀텀과 세분도

- 아키텍쳐 퀀텀의 정의: 높은 기능 응집도(high functional cohesion)와 동기적 커네이선스(synchronous connascence)를 가진,  
  독립적으로 배포 가능한(independently deployable) 아티팩트

- 위 한 문장에는 아래의 개념들이 담겨있다.

  - 독립적 배포 가능: 아키텍쳐 퀀텀은 아키텍쳐의 다른 파트와 독립적으로 작동되는 모든 필수 컴포넌트를 포함한다. 예를 들어 DB를 사용하는  
    애플리케이션은 DB 없이는 작동되지 않으니 DB는 퀀텀의 일부이다. 단일 DB를 사용해 배포된 거의 모든 레거시 시스템은 아키텍쳐 퀀텀이 1이지만,  
    MSA는 서비스마다 DB가 따로 있으니 퀀텀이 여러 개이다.

  - 높은 기능 응집도: 응집도는 컴포넌트의 설계에 따라 구현된 코드가 얼마나 목적에 맞게 통합되어 있는지를 나타낸다. 예를 들어 `Customer`  
    컴포넌트는 고객과 관련된 모든 프로퍼티와 메소드를 가지기에 응집도가 높지만, `Utility`와 같은 컴포넌트는 여러 가지 잡다한 메소드들을  
    무작위로 섞어 놓았기에 응집도가 낮은 편이다. 기능 응집도가 높다는 것은 아키텍쳐 퀀텀이 목적에 맞는 뭔가를 하고 있다는 뜻이다.  
    단일 DB를 사용하는 기존 모놀리식 애플리케이션에서는 이런 구분이 별로 의미가 없지만, MSA는 보통 개발자가 각 서비스를 하나의  
    workflow에 맞게 설계하므로 기능 응집도가 높게 나타난다.

  - 동기적 커네이선스: 동기적 커네이선스는 아키텍쳐 퀀텀을 형성하는 애플리케이션 컨텍스트 내부 또는 분산 서비스간의 동기 호출을 의미한다.  
    예를 들어 MSA 에서 어떤 서비스가 다른 서비스를 동기 호출할 때, 운영 아키텍쳐 특성 측면에서 두 서비스는 두드러진 차이를 나타낼 수 없다.  
    호출부가 피호출부보다 확장성이 훨씬 좋다면 타임아웃과 여타 신뢰성 문제가 일어날 것이다. 따라서 동기 호출은 동적 커네이선스를 만들어낸다.

- 아키텍쳐 퀀텀 개념은 아키텍쳐 특성의 새로운 범위를 제시한다. 현대 시스템에서 아키텍트는 시스템 레벨 보다는 퀀텀 레벨의  
  아키텍쳐 특성을 정의한다.

---
